(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2a40"],{AV4t:function(t,e,o){"use strict";o.d(e,"h",function(){return r}),o.d(e,"e",function(){return n}),o.d(e,"b",function(){return l}),o.d(e,"d",function(){return i}),o.d(e,"g",function(){return s}),o.d(e,"f",function(){return u}),o.d(e,"c",function(){return c}),o.d(e,"a",function(){return d});var a=o("t3Un");function r(t){return Object(a.a)({headers:{"Content-Type":"multipart/form-data"},url:"/qualityBom/importBom",method:"post",data:t})}function n(t,e,o){return Object(a.a)({url:"/qualityBom/getBomList",method:"get",params:{keyword:t,page:o,rows:e}})}function l(t){return Object(a.a)({url:"/qualityBom/delete",method:"post",params:{fileId:t}})}function i(t){return Object(a.a)({url:"/qualityBom/getBomData",method:"get",params:{fileId:t}})}function s(t){return Object(a.a)({url:"/qualityBom/getK3Bom",method:"get",params:t})}function u(t){return Object(a.a)({url:"/qualityBom/getBomMatch",method:"get",params:{bomId:t}})}function c(t,e){return Object(a.a)({url:"/qualityBom/doCheckMateriel",method:"post",params:{id:t,checkStatus:e}})}function d(t){return Object(a.a)({url:"/qualityBom/addMate",method:"post",params:t})}},LZK6:function(t,e,o){"use strict";o.r(e);var a=o("6ZY3"),r=o.n(a),n=o("AV4t"),l={props:{contents:{type:String,default:"这是一段内容"},title:{type:String,default:"标题名称"},confirmTitle:{type:String,default:"确认"}},methods:{open:function(){var t=this,e=this;this.$confirm(this.contents,this.title,{distinguishCancelAndClose:!0,confirmButtonText:this.confirmTitle,cancelButtonText:"取消",showClose:!0,type:"warning"}).then(function(){e.$emit("callConfirm")}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},i=o("ZrdR"),s=Object(i.a)(l,function(){var t=this.$createElement;return(this._self._c||t)("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:this.open}},[this._v("删除")])},[],!1,null,null,null);s.options.__file="MessageBox.vue";var u=s.exports,c=o("zF5t"),d=o("i2sM"),m={name:"qualityBomDetail",components:{MessageBoxDelete:u},data:function(){return{tableData:[],tableHeader:[],labelPosition:"right",isShow:!1,isShowTable:!1,activeNames:["1"],fileId:"",expands:[],load:!1,fillPercent:0,fAuxPriceTotal:0,fAuxPrice3MonthMaxTotal:0,fAuxPrice3MonthMinTotal:0,fillNum:0,totalNum:0,color:"#f56c6c",loading:!1,docVisible:!1,bsFileId:0,multipleSelection:[],formQuery:{brandNumberCol:"",isCustomer:0},optionHearder:[],bomParamsId:"",rules:{brandNumberCol:[{required:!0,message:"请选择品牌料号列",trigger:"change"}]},currentRow:[],showMateVisible:!1,mateCode:"",showMateList:[],showBomId:0,statusFilter:function(t){return{0:"info",1:"info"}[t]},formatStatus:function(t){return{0:"否",1:"是"}[t]},formatStatusQt:function(t){return{0:"未报价",1:"未报价",2:"已报价",3:"审核中",4:"已采纳",5:"未采纳"}[t]},isBomPrice:!1}},created:function(){var t=this;this.$route.query.fileId&&this.getBomDateByFileId(this.$route.query.fileId),Object(c.f)().then(function(e){e.result?1==e.data.isSuper?t.isBomPrice=!0:""!=e.data.perm&&e.data.perm.indexOf("BOM_PRICE")>=0&&(t.isBomPrice=!0):t.$message.error(e.msg)})},computed:{},methods:{returnFloat:function(t){if(null==t||void 0==t)return"0.000000";var e=(t=Math.round(1e6*parseFloat(t))/1e6).toString().split(".");if(1==e.length)return t=t.toString()+".000000";if(e.length>1){for(var o="",a=0;a<6-e[1].length;a++)o=o.toString()+"0";return t=t.toString()+o}},tableRowClassName:function(t){var e=t.row;t.rowIndex;return 1==e.checkStatus?"success-row":"warning-row"},getBomDateByFileId:function(t){var e=this;Object(n.d)(t).then(function(o){o.result?(e.tableHeader=o.data.header,e.tableData=o.data.results,e.optionHearder=[],e.optionHearder.push({value:"",label:"无"}),e.tableHeader.forEach(function(t){var o={value:t,label:t};e.optionHearder.push(o)}),o.data.bomParams.brandNumberCol&&(e.formQuery.brandNumberCol=o.data.bomParams.brandNumberCol),e.bomParamsId=o.data.bomParams.id,e.fileId=t,e.isShowTable=!0,e.isShow=!0):e.$message.error(o.msg)})},toList:function(){this.$router.push({path:"qualityBomList",query:this.$route.query})},handleSelectionChange:function(t){this.multipleSelection=t},doSimilarity:function(t){var e=this;this.load=!0,this.$refs[t].validate(function(t){if(!t)return e.load=!1,e.$message.error("请设置好品牌料号对应的列！"),!1;var o=r()({},e.formQuery,{fileId:e.fileId});Object(n.g)(o).then(function(t){t.result?(e.$message.info("匹配成功，请点击行展开查看!"),e.tableHeader=t.data.header,e.tableData=t.data.results,e.isShowTable=!0,e.load=!1,location.reload()):e.$message.error(t.msg)})})},rowExpand:function(t,e){var o=this;this.loading=!0,this.currentRow=t,Object(n.f)(t.bomId).then(function(e){if(!e.result)return o.loading=!1,void o.$message.error(e.msg);t.childrenData=e.data.bomMatchList,o.currentRow.checkStatus=e.data.bomList.checkStatus,o.currentRow.checkCode=e.data.bomList.checkCode,o.loading=!1}),e.length>1&&e.shift()},doCheck:function(t,e){var o=this;Object(n.c)(e.id,t).then(function(e){e.result?(o.$message.info("操作成功!"),o.currentRow.childrenData=e.data.bomMatchList,o.currentRow.checkStatus=t,o.currentRow.checkCode=e.data.bomList.checkCode):o.$message.error(e.msg)})},showMateView:function(t){this.showBomId=t,this.showMateVisible=!0},searchMate:function(){var t=this,e=r()({},{mateCode:this.mateCode});Object(d.b)(e).then(function(e){e.result?t.showMateList=e.data:t.$message.error(e.msg)})},chooseMate:function(t){var e=this;this.showMateVisible=!1;var o=r()({},{id:t.id,bomId:this.showBomId});Object(n.a)(o).then(function(t){if(t.result){var o=t.data.id;Object(n.c)(o,1).then(function(o){o.result?(e.currentRow.childrenData=o.data.bomMatchList,e.currentRow.checkStatus=1,e.currentRow.checkCode=o.data.bomList.checkCode):e.$message.error(t.msg)})}else e.$message.error(t.msg)})},exportBom:function(){window.location.href="http://113.106.72.75:9345/logistics//qualityBom/getBomExcel?fileId="+this.fileId}}},f=(o("n++x"),Object(i.a)(m,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.load,expression:"load"}],attrs:{"element-loading-text":"数据加载中，请稍等"}},[o("el-row",{staticStyle:{"margin-bottom":"5px","margin-top":"5px"}},[o("el-col",{attrs:{span:16}},[o("el-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"button"},on:{click:t.toList}},[t._v("返回")])],1)],1),t._v(" "),o("el-collapse",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[o("el-collapse-item",{staticClass:"collapse",attrs:{title:"设置参数",name:"1"}},[o("el-row",[o("el-col",{staticStyle:{"margin-bottom":"-10px"},attrs:{span:24}},[o("el-form",{ref:"formQuery",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formQuery,rules:t.rules,"label-width":"60px","label-position":t.labelPosition}},[o("el-col",{staticStyle:{"margin-bottom":"-10px","margin-top":"5px"},attrs:{span:24}},[o("el-form-item",{attrs:{label:"品牌料号"}},[o("el-select",{staticStyle:{width:"185px"},attrs:{placeholder:"品牌料号"},model:{value:t.formQuery.brandNumberCol,callback:function(e){t.$set(t.formQuery,"brandNumberCol",e)},expression:"formQuery.brandNumberCol"}},t._l(t.optionHearder,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),o("el-col",[o("el-form-item",{staticStyle:{"margin-left":"15px"}},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.doSimilarity("formQuery")}}},[t._v("开始匹配K3数据")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.exportBom()}}},[t._v("导出Excel")])],1)],1)],1)],1)],1)],1)],1),t._v(" "),o("el-table",{directives:[{name:"show",rawName:"v-show",value:t.isShowTable,expression:"isShowTable"}],ref:"multipleTable",staticClass:"sometable",staticStyle:{"overflow-x":"auto"},attrs:{"max-height":"600",data:t.tableData,border:"","row-class-name":t.tableRowClassName,"row-key":"bomId"},on:{"expand-change":t.rowExpand,"selection-change":t.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"45"}}),t._v(" "),o("el-table-column",{attrs:{type:"expand",prop:"children"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[o("el-button",{staticStyle:{"margin-top":"10px","margin-left":"47px"},attrs:{type:"primary"},on:{click:function(o){t.showMateView(e.row.bomId)}}},[t._v("查询物料")]),t._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"1154px","margin-top":"10px","margin-left":"47px","font-size":"12px"},attrs:{data:e.row.childrenData,border:"","element-loading-text":"数据加载中，请稍等","highlight-current-row":!0}},[o("el-table-column",{attrs:{label:"序号",type:"index",width:"50","show-overflow-tooltip":"",fixed:""}}),t._v(" "),o("el-table-column",{attrs:{prop:"fNumber",label:"物料编号",width:"110","show-overflow-tooltip":"",fixed:""}}),t._v(" "),o("el-table-column",{attrs:{prop:"fName",label:"物料名称",width:"90","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"fModel",label:"物料规格",width:"283","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"mateCusName",label:"品牌",width:"100","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"mateCusCode",label:"品牌料号",width:"180","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"suppChineseName",label:"供应商",width:"100","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"modifiedName",label:"修改人",width:"80","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{label:"状态",width:"60",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.checkStatus?o("span",{staticStyle:{color:"green","font-weight":"bold"}},[t._v("未选中")]):t._e(),t._v(" "),1===e.row.checkStatus?o("span",{staticStyle:{color:"red","font-weight":"bold"}},[t._v("已选中")]):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"取消/选中",width:"100",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.checkStatus?o("el-button",{attrs:{type:"success",icon:"el-icon-check"},on:{click:function(o){t.doCheck("1",e.row)}}},[t._v("选中")]):t._e(),t._v(" "),1===e.row.checkStatus?o("el-button",{attrs:{type:"danger",icon:"el-icon-close"},on:{click:function(o){t.doCheck("0",e.row)}}},[t._v("取消")]):t._e()]}}])})],1)],1)]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"是否匹配",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(t.formatStatus(e.row.checkStatus)))])]}}])}),t._v(" "),t._l(t.tableHeader,function(e){return"mateCategory"!=e?o("el-table-column",{key:e,attrs:{prop:e,label:e,width:"150","show-overflow-tooltip":""}}):t._e()}),t._v(" "),o("el-table-column",{attrs:{prop:"checkCode",label:"选中的物料号",width:"150","show-overflow-tooltip":""}})],2),t._v(" "),o("el-dialog",{attrs:{title:"K3物料列表",visible:t.showMateVisible,width:"1000px"},on:{"update:visible":function(e){t.showMateVisible=e}}},[o("div",[o("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[o("el-form-item",{attrs:{label:"物料编号"}},[o("el-input",{attrs:{placeholder:"请准确输入物料编号"},model:{value:t.mateCode,callback:function(e){t.mateCode=e},expression:"mateCode"}})],1),t._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:t.searchMate}},[t._v("查找")])],1)],1)],1),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.showMateList,"tooltip-effect":"dark"}},[o("el-table-column",{attrs:{prop:"mateK3Code",label:"编号","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"mateName",label:"名称","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"mateModel",label:"规格","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"suppChineseName",label:"供应商名称","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{label:"操作",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary"},on:{click:function(o){t.chooseMate(e.row)}}},[t._v("选择")])]}}])})],1),t._v(" "),o("div",{staticClass:"mateFooter"},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showMateVisible=!1}}},[t._v("关闭")])],1)],1)],1)},[],!1,null,null,null));f.options.__file="qualityBomDetail.vue";e.default=f.exports},agv9:function(t,e,o){},i2sM:function(t,e,o){"use strict";o.d(e,"b",function(){return r}),o.d(e,"a",function(){return n}),o.d(e,"c",function(){return l});var a=o("t3Un");function r(t){return Object(a.a)({url:"/costMate/getMateList",method:"get",params:t})}function n(t){return Object(a.a)({url:"/costMate/addMate",method:"post",params:t})}function l(t){return Object(a.a)({headers:{"Content-Type":"multipart/form-data"},url:"/costMate/getK3Mate",method:"post",data:t})}},"n++x":function(t,e,o){"use strict";var a=o("agv9");o.n(a).a},zF5t:function(t,e,o){"use strict";o.d(e,"a",function(){return r}),o.d(e,"g",function(){return n}),o.d(e,"e",function(){return l}),o.d(e,"i",function(){return i}),o.d(e,"d",function(){return s}),o.d(e,"c",function(){return u}),o.d(e,"b",function(){return c}),o.d(e,"h",function(){return d}),o.d(e,"f",function(){return m});var a=o("t3Un");function r(t){return Object(a.a)({url:"/sysRole/add",method:"post",data:t})}function n(t,e,o,r){return Object(a.a)({url:"/sysRole/getlist",method:"get",params:{roleCode:t,roleName:e,page:o,rows:r}})}function l(t){return Object(a.a)({url:"/sysRole/getCheckedRoles",method:"get",params:{userId:t}})}function i(t,e){return Object(a.a)({url:"/sysRole/saveUserRoles",method:"get",params:{userId:t,roles:e}})}function s(t){return Object(a.a)({url:"/sysRole/edite",method:"post",data:t})}function u(t){return Object(a.a)({url:"/sysRole/delete",method:"post",params:{id:t}})}function c(t){return Object(a.a)({url:"/sysRole/addRouter",method:"get",params:t})}function d(t){return Object(a.a)({url:"/sysRole/getRouter",method:"get",params:{roleCode:t}})}function m(t){return Object(a.a)({url:"/sysRole/getPermission",method:"get",params:t})}}}]);