(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0d3b"],{bG4Z:function(e,t,o){"use strict";o.d(t,"c",function(){return a}),o.d(t,"a",function(){return l}),o.d(t,"b",function(){return i});var r=o("t3Un");function a(){return Object(r.a)({url:"/sysRouter/getTreeList",method:"get"})}function l(e){return Object(r.a)({url:"/sysRouter/add",method:"post",data:e})}function i(e){return Object(r.a)({url:"/sysRouter/delete",method:"post",params:{id:e}})}},bvmk:function(e,t,o){},sFVv:function(e,t,o){"use strict";var r=o("bvmk");o.n(r).a},u5aJ:function(e,t,o){"use strict";o.r(t);var r=o("6ZY3"),a=o.n(r),l=o("Q2cO"),i=o.n(l),n=o("zF5t"),s=o("bG4Z"),u={name:"roleManagement",data:function(){return{dialogVisible:!1,rolesDate:[],checkedRolesDate:[],value4:[],formQuery:{roleCode:"",roleName:""},currentRow:[],roleTable:[{}],checkekList:[],dialog:{loading:!1,modal_dialog:!1,formItem:{},ruleForm:{roleCode:[{required:!0,message:"请填写角色编号",trigger:"blur"}],roleName:[{required:!0,message:"请填写名称",trigger:"blur"}]}},queryParams:{page:1,rows:15,pkParent:-1},pageSizesList:[10,15,20,30,40,50,100],totalCount:0,treeList:[],options:{label:"routerName",children:"children",id:"id",isLeaf:!0},routerDialog:!1}},created:function(){this.getData()},methods:{handleSubmit:function(e){this.getData()},getData:function(){var e=this;Object(n.g)(this.formQuery.roleCode,this.formQuery.roleName,this.queryParams.rows,this.queryParams.page).then(function(t){t.data||reject("error"),e.roleTable=t.data.rows,e.totalCount=t.data.total})},showAddDialog:function(){this.dialog.modal_dialog=!0,this.dialog.formItem={id:""}},showEditDialog:function(){if(this.currentRow){this.dialog.modal_dialog=!0;var e=this.currentRow;this.dialog.formItem={roleCode:e.roleCode,roleName:e.roleName,id:e.id,roleComment:e.roleComment}}else this.$message.error("请选择要操作的行!")},doDelete:function(){var e=this;if(this.currentRow){var t=this.currentRow.id;Object(n.c)(t).then(function(t){t.result?(e.$message({message:t.msg,type:"success"}),e.getData()):e.$message.error(t.msg)})}else this.$message.error("请选择要操作的行!")},handleSelectionChange:function(e){this.currentRow=e[e.length-1]},select:function(e,t){e.length>1&&e.shift()},ok:function(){var e=this;void 0!=i()(this.dialog.formItem.id)&&"number"==typeof this.dialog.formItem.id?this.$refs.adduserForm.validate(function(t){t&&Object(n.d)(e.dialog.formItem).then(function(t){e.dialog.loading=!1,t.result?(e.dialog.loading=!1,e.dialog.modal_dialog=!1,e.getData()):e.$message.error(res.msg)})}):this.$refs.adduserForm.validate(function(t){t&&Object(n.a)(e.dialog.formItem).then(function(t){t.result?(e.dialog.loading=!1,e.dialog.modal_dialog=!1,e.getData()):e.$message.error(res.msg)})})},saveRoles:function(){var e=this,t=this.currentRow[0].id;Object(n.i)(t,this.value4.toString()).then(function(t){e.$message.info(t.msg)})},handleChange:function(e,t,o){console.log(e,t,o)},cancel:function(){this.dialog.modal_dialog=!1},changePage:function(e){this.queryParams.page=e,this.getData()},SizeChange:function(e){this.queryParams.rows=e,this.getData()},showRouterDialog:function(){var e=this;console.log(this.currentRow),0!=this.currentRow.length?Object(n.h)(this.currentRow.roleCode).then(function(t){t.result?(e.checkekList=t.data,e.getTree(),e.routerDialog=!0):e.$message.error(t.msg)}):this.$message.error("请选择要操作的行!")},getTree:function(){var e=this;Object(s.c)().then(function(t){if(t.result){var o={routerName:"目录",id:1,children:[]};o.children=t.data,e.treeList=[o],e.treeList.length>0&&e.showRouter()}})},addRouter:function(){var e=this,t=this.$refs.tree.getCheckedKeys();this.array=[];for(var o=0;o<t.length;o++)this.fun(t[o],this.treeList,this.array);if(this.array.length>0){var r={roleCode:this.currentRow.roleCode,roles:this.array.join(";")},l=a()(r);Object(n.b)(l).then(function(t){t.result?(e.$message({message:"操作成功",type:"success"}),e.routerDialog=!1):e.$message.error(t.msg)})}},noRepeat:function(e,t){for(var o=0;o<e.length;o++)if(e[o]==t)return!1;return!0},fun:function(e,t,o){for(var r=0;r<t.length;r++){var a=t[r];if(a.id==e)return this.noRepeat(o,a.id)&&1!=a.id&&this.array.push(a.id),!0;if(a.children&&this.fun(e,a.children,o))return this.noRepeat(o,a.id)&&1!=a.id&&this.array.push(a.id),!0}return!1},removeParent:function(e,t){for(var o=0;o<t.length;o++){var r=t[o];if(r.id==e)return 0!=r.children.length||(this.array.push(r.id),!0);0!=r.children.length&&this.removeParent(e,r.children)}return!0},showRouter:function(){var e=this.checkekList;this.array=[];for(var t=0;t<e.length;t++)this.removeParent(e[t],this.treeList);this.checkekList=this.array},setPermPage:function(){0!=this.currentRow.length?this.$router.push({path:"permRoleResource",query:{id:this.currentRow.id}}):this.$message.error("请选择要操作的行!")}}},d=(o("sFVv"),o("ZrdR")),c=Object(d.a)(u,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-card",[o("el-row",[o("el-col",{attrs:{span:14}},[o("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formQuery}},[o("el-form-item",{attrs:{label:"角色编号"}},[o("el-input",{attrs:{placeholder:"角色编号"},model:{value:e.formQuery.roleCode,callback:function(t){e.$set(e.formQuery,"roleCode",t)},expression:"formQuery.roleCode"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"角色名称"}},[o("el-input",{attrs:{placeholder:"角色名称"},model:{value:e.formQuery.roleName,callback:function(t){e.$set(e.formQuery,"roleName",t)},expression:"formQuery.roleName"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.handleSubmit("formQuery")}}},[e._v("查找")])],1)],1)],1),e._v(" "),o("el-col",{attrs:{span:10}},[o("el-button-group",{attrs:{size:"small"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.showAddDialog()}}},[e._v("新增")]),e._v(" "),o("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:function(t){e.doDelete()}}},[e._v("删除")]),e._v(" "),o("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){e.showEditDialog()}}},[e._v("编辑")])],1),e._v(" "),o("el-button-group",{attrs:{size:"small"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-view"},on:{click:e.showRouterDialog}},[e._v("页面权限")]),e._v(" "),o("el-button",{attrs:{type:"primary",icon:"el-icon-view"},on:{click:function(t){e.setPermPage()}}},[e._v("操作权限")])],1)],1)],1)],1),e._v(" "),[o("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",data:e.roleTable,"tooltip-effect":"dark"},on:{select:e.select,"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"45"}}),e._v(" "),o("el-table-column",{attrs:{prop:"roleCode",label:"角色编号","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{prop:"roleName",label:"角色名称","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{prop:"createdTime",label:"创建时间",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(void 0!=t.row.createdTime&&null!==t.row.createdTime?t.row.createdTime.substring(0,10):""))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"modifiedTime",align:"center",label:"更新时间","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(void 0!=t.row.modifiedTime&&null!==t.row.modifiedTime?t.row.modifiedTime.substring(0,10):"")+"\n                ")])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"roleComment",label:"备注","show-overflow-tooltip":""}})],1)],e._v(" "),o("div",{staticClass:"block"},[o("el-pagination",{staticClass:"pull-right clearfix",attrs:{current:1,"current-page":e.queryParams.page,"page-sizes":e.pageSizesList,"page-size":e.queryParams.rows,layout:"total, sizes, prev, pager, next, jumper","page-size-opts":e.pageSizesList,total:e.totalCount},on:{"current-change":e.changePage,"size-change":e.SizeChange,"update:currentPage":function(t){e.$set(e.queryParams,"page",t)}}})],1),e._v(" "),o("el-dialog",{ref:"dialog.addRole",attrs:{visible:e.dialog.modal_dialog,title:"角色管理",width:"500px",modal:!0,"close-on-click-modal":!1,"close-on-press-escape":!0,"append-to-body":""},on:{"update:visible":function(t){e.$set(e.dialog,"modal_dialog",t)}}},[o("el-form",{ref:"adduserForm",attrs:{model:e.dialog.formItem,rules:e.dialog.ruleForm,"label-width":"100px"}},[o("el-row",[o("el-col",{attrs:{span:20}},[o("el-form-item",{staticStyle:{display:"none"},attrs:{label:"id",prop:"id"}},[o("el-input",{attrs:{size:"small",placeholder:"请输入"},model:{value:e.dialog.formItem.id,callback:function(t){e.$set(e.dialog.formItem,"id",t)},expression:"dialog.formItem.id"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:20}},[o("el-form-item",{attrs:{label:"角色编码",prop:"roleCode"}},[o("el-input",{attrs:{size:"small",placeholder:"请输入",disabled:e.dialog.formItem.id>0},model:{value:e.dialog.formItem.roleCode,callback:function(t){e.$set(e.dialog.formItem,"roleCode",t)},expression:"dialog.formItem.roleCode"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:20}},[o("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[o("el-input",{attrs:{size:"small",placeholder:"请输入"},model:{value:e.dialog.formItem.roleName,callback:function(t){e.$set(e.dialog.formItem,"roleName",t)},expression:"dialog.formItem.roleName"}})],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:20}},[o("el-form-item",{attrs:{label:"备注",prop:"roleComment"}},[o("el-input",{attrs:{size:"small",type:"textarea",placeholder:"请输入..."},model:{value:e.dialog.formItem.roleComment,callback:function(t){e.$set(e.dialog.formItem,"roleComment",t)},expression:"dialog.formItem.roleComment"}})],1)],1)],1)],1),e._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",size:"small",loading:!1},on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"small",loading:e.dialog.loading},on:{click:e.ok}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{ref:"routerDialog",attrs:{visible:e.routerDialog,title:"分配权限",width:"500px",modal:!0,"close-on-click-modal":!1,"close-on-press-escape":!0,"append-to-body":""},on:{"update:visible":function(t){e.routerDialog=t}}},[o("el-tree",{ref:"tree",attrs:{"node-key":"id","show-checkbox":"",data:e.treeList,props:e.options,"highlight-current":"","default-expand-all":"","default-checked-keys":e.checkekList}}),e._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",size:"small",loading:!1},on:{click:function(t){e.routerDialog=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"small",loading:e.dialog.loading},on:{click:e.addRouter}},[e._v("确 定")])],1)],1)],2)},[],!1,null,null,null);c.options.__file="roleManagement.vue";t.default=c.exports},zF5t:function(e,t,o){"use strict";o.d(t,"a",function(){return a}),o.d(t,"g",function(){return l}),o.d(t,"e",function(){return i}),o.d(t,"i",function(){return n}),o.d(t,"d",function(){return s}),o.d(t,"c",function(){return u}),o.d(t,"b",function(){return d}),o.d(t,"h",function(){return c}),o.d(t,"f",function(){return m});var r=o("t3Un");function a(e){return Object(r.a)({url:"/sysRole/add",method:"post",data:e})}function l(e,t,o,a){return Object(r.a)({url:"/sysRole/getlist",method:"get",params:{roleCode:e,roleName:t,page:o,rows:a}})}function i(e){return Object(r.a)({url:"/sysRole/getCheckedRoles",method:"get",params:{userId:e}})}function n(e,t){return Object(r.a)({url:"/sysRole/saveUserRoles",method:"get",params:{userId:e,roles:t}})}function s(e){return Object(r.a)({url:"/sysRole/edite",method:"post",data:e})}function u(e){return Object(r.a)({url:"/sysRole/delete",method:"post",params:{id:e}})}function d(e){return Object(r.a)({url:"/sysRole/addRouter",method:"get",params:e})}function c(e){return Object(r.a)({url:"/sysRole/getRouter",method:"get",params:{roleCode:e}})}function m(e){return Object(r.a)({url:"/sysRole/getPermission",method:"get",params:e})}}}]);