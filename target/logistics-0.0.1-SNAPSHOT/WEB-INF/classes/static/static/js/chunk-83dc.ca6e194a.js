(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-83dc"],{Acpg:function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"c",function(){return a}),r.d(e,"b",function(){return o}),r.d(e,"f",function(){return s}),r.d(e,"d",function(){return l}),r.d(e,"g",function(){return u}),r.d(e,"e",function(){return c});var n=r("t3Un");function i(t){return Object(n.a)({url:"/sysPermission/add",method:"post",params:t})}function a(t){return Object(n.a)({url:"/sysPermission/edit",method:"post",params:t})}function o(t){return Object(n.a)({url:"/sysPermission/delete",method:"post",params:{id:t}})}function s(t,e,r){return Object(n.a)({url:"/sysPermission/getlist",method:"get",params:{keyword:t,page:r,rows:e}})}function l(t,e){return Object(n.a)({url:"/sysPermission/getPermByRouter",method:"post",params:{roleId:t,routerId:e}})}function u(t){return Object(n.a)({url:"/sysPermission/setPerm",method:"post",params:t})}function c(t){return Object(n.a)({url:"/sysPermission/getPermByRouterCode",method:"get",params:{routerCode:t}})}},CSap:function(t,e,r){},Q9EI:function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"e",function(){return a}),r.d(e,"b",function(){return o}),r.d(e,"f",function(){return s}),r.d(e,"c",function(){return l}),r.d(e,"d",function(){return u});var n=r("t3Un");function i(t){return Object(n.a)({headers:{"Content-Type":"multipart/form-data"},url:"/qualityFile/add",method:"post",data:t})}function a(t){return Object(n.a)({headers:{"Content-Type":"multipart/form-data"},url:"/qualityFile/edit",method:"post",data:t})}function o(t){return Object(n.a)({url:"/qualityFile/delete",method:"post",params:{id:t}})}function s(t,e,r,i,a){return Object(n.a)({url:"/qualityFile/getlist",method:"get",params:{keyword:t,bsStatus:e,mateId:r,page:a,rows:i}})}function l(t){return Object(n.a)({url:"/qualityFile/doApproval",method:"post",params:t})}function u(t){return Object(n.a)({url:"/qualityFile/doBack",method:"post",params:t})}},c48m:function(t,e,r){"use strict";var n=r("CSap");r.n(n).a},dYim:function(t,e,r){"use strict";r.r(e);var n=r("6ZY3"),i=r.n(n),a=r("Q9EI"),o=r("Acpg"),s={name:"qualityFileList",components:{MessageBox:r("3Y2C").a},data:function(){return{mateId:this.$route.query.mateId,current:0,open:!0,isReadOnly:!0,isdisabled:!0,dialog:{loading:!1,dialogVisible:!1},multipleSelection:[],formLabelWidth:"100px",formQuery:{keyword:"",bsStatus:0},currentRow:[],currentId:"",fileTable:[{}],queryParams:{page:1,rows:10,pkParent:-1},pageSizesList:[10,20,30,40,50,100],totalCount:0,loading:!1,permit:{SEARCH:!1,UPLOAD:!1,DELETE:!1,DOWNLOAD:!1,PASS:!1},items:[{sort:"全部"},{sort:"待审核"},{sort:"审核通过"},{sort:"审核不通过"}],statusFilter:function(t){return{1:"primary",2:"success",3:"danger"}[t]},formatStata:function(t){return{1:"待审核",2:"审核通过",3:"审核不通过"}[t]}}},created:function(){this.getData(),this.getPermit()},mounted:function(){},methods:{addClass:function(t){this.current=t},changeStatus:function(t){this.formQuery.bsStatus=t,this.getData()},handleSubmit:function(t){this.getData()},getPermit:function(){var t=this,e=this.$route.name;Object(o.e)(e).then(function(e){if(e.result)if("admin"==e.data)t.permit.SEARCH=!0,t.permit.UPLOAD=!0,t.permit.DELETE=!0,t.permit.DOWNLOAD=!0,t.permit.PASS=!0;else for(var r=e.data,n=0;n<r.length;n++)"SEARCH"==r[n].permCode&&(t.permit.SEARCH=!0),"UPLOAD"==r[n].permCode&&(t.permit.ADD=!0),"DELETE"==r[n].permCode&&(t.permit.DELETE=!0),"DOWNLOAD"==r[n].permCode&&(t.permit.DOWNLOAD=!0),"PASS"==r[n].permCode&&(t.permit.PASS=!0);else t.$message.error(e.msg)})},getData:function(){var t=this;this.loading=!0,Object(a.f)(this.formQuery.keyword,this.formQuery.bsStatus,this.$route.query.mateId,this.queryParams.rows,this.queryParams.page).then(function(e){e.result?(t.fileTable=e.data.rows,t.totalCount=e.data.total,t.loading=!1):t.$message.error(e.msg)})},viewFile:function(t){},cellClass:function(t){if(0===t.columnIndex)return"disabledSelection"},handleSelectionChange:function(t){this.multipleSelection=t,t.length>0?this.currentRow=t[t.length-1]:this.currentRow=[]},select:function(t,e){t.length>1&&(t.shift(),this.multipleSelection=t)},cancel:function(){this.dialog.modal_dialog=!1},changePage:function(t){this.queryParams.page=t,this.getData()},SizeChange:function(t){this.queryParams.rows=t,this.getData()},addDoc:function(t){var e=this,r=t.target.files[0];if(null!=r&&void 0!=r){var n=new FormData;n.append("file",r),n.append("mateId",this.mateId),Object(a.a)(n).then(function(t){t.result?(e.$message.info(t.msg),e.getData()):e.$message.error(t.msg)})}},addDocBefore:function(){this.$refs["doc-upload-input"].click()},editDoc:function(t){var e=this,r=t.target.files[0],n=new FormData;n.append("file",r),n.append("id",this.currentId),Object(a.e)(n).then(function(t){t.result?(e.$message.info(t.msg),e.currentId="",e.getData()):(e.$message.error(t.msg),e.currentId="")})},editDocBefore:function(t){this.currentId=t,this.$refs["doc-upload-input2"].click()},downloadDoc:function(t){window.location.href="http://113.106.72.75:9345/logistics//file/get?fsFileId="+t},doDelete:function(t){var e=this,r=t.id;Object(a.b)(r).then(function(t){t.result?(e.$message({message:t.msg,type:"success"}),e.getData()):e.$message.error(t.msg)})},approval:function(t){var e=this;if(1==this.multipleSelection.length){var r=i()({},{id:this.currentRow.id,bsStatus:t});Object(a.c)(r).then(function(t){t.result?(e.$message.info(t.msg),e.getData()):e.$message.error(t.msg)})}else 0==this.multipleSelection.length?this.$message.error("请选择选择质量文件！"):this.$message.error("只能选择一个质量文件！")},reject:function(){var t=this;if(1==this.multipleSelection.length){var e=i()({},{id:this.currentRow.id});Object(a.d)(e).then(function(e){e.result?(t.$message.info(e.msg),t.getData()):t.$message.error(e.msg)})}else 0==this.multipleSelection.length?this.$message.error("请选择选择质量文件！"):this.$message.error("只能选择一个质量文件！")},resetFrom:function(){this.formQuery.keyword=""}}},l=(r("c48m"),r("ZrdR")),u=Object(l.a)(s,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-row",[r("el-col",{attrs:{span:24}},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"数据加载中，请稍等"}},[r("div",{staticClass:"retrieval"},[r("div",{staticClass:"title"},[r("h3",[t._v("状态")]),t._v(" "),r("div",{staticClass:"filter"},[r("ul",t._l(t.items,function(e,n){return r("li",{key:n,class:{current:n==t.current},on:{click:function(e){t.addClass(n)}}},[r("a",{on:{click:function(e){t.changeStatus(n)}}},[r("span",[t._v(t._s(e.sort))])])])}))]),t._v(" "),r("span",{staticClass:"more",on:{click:function(e){t.open=!t.open}}})]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"searchDiv"},[r("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formQuery}},[r("el-form-item",{attrs:{label:"关键字"}},[r("el-input",{attrs:{placeholder:"关键字"},model:{value:t.formQuery.keyword,callback:function(e){t.$set(t.formQuery,"keyword",e)},expression:"formQuery.keyword"}})],1),t._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"info"},on:{click:t.resetFrom}},[t._v("重置")]),t._v(" "),t.permit.SEARCH?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.handleSubmit("formQuery")}}},[t._v("查找")]):t._e(),t._v(" "),t.permit.UPLOAD?r("el-button",{attrs:{type:"primary"},on:{click:t.addDocBefore}},[t._v("上传文件\n                "),r("input",{ref:"doc-upload-input",staticClass:"doc-upload-input",attrs:{type:"file"},on:{change:t.addDoc}})]):t._e(),t._v(" "),t.permit.PASS?r("el-button",{attrs:{type:"success"},on:{click:function(e){t.approval(2)}}},[t._v("审核通过")]):t._e(),t._v(" "),t.permit.PASS?r("el-button",{attrs:{type:"danger"},on:{click:function(e){t.approval(3)}}},[t._v("审核不通过")]):t._e(),t._v(" "),t.permit.PASS?r("el-button",{attrs:{type:"warning"},on:{click:function(e){t.reject()}}},[t._v("驳回")]):t._e()],1)],1)],1)]),t._v(" "),[r("el-table",{ref:"fileTable",staticStyle:{width:"100%"},attrs:{data:t.fileTable,"tooltip-effect":"dark","highlight-current-row":"",border:"","header-cell-class-name":t.cellClass},on:{select:t.select,"selection-change":t.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"45",disable:"true"}}),t._v(" "),r("el-table-column",{attrs:{prop:"bsStatus",label:"审核状态",align:"center",width:"100","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-tag",{attrs:{type:t.statusFilter(e.row.bsStatus)}},[t._v(t._s(t.formatStata(e.row.bsStatus)))])]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"mateK3Code",label:"K3物料号",width:"130","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{prop:"fileName",label:"文件名称","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{prop:"modifiedName",label:"操作人",width:"100",align:"center","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{prop:"createdTime",label:"创建时间",width:"150",align:"center","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"操作",width:"100",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.permit.DOWNLOAD?r("el-button",{attrs:{type:"primary",icon:"el-icon-download",size:"mini",title:"下载",circle:""},on:{click:function(r){t.downloadDoc(e.row.fileId)}}}):t._e(),t._v(" "),t.permit.DELETE?r("MessageBox",{attrs:{title:"提示",contents:"此操作将永久删除该行, 是否继续?",confirmTitle:"确认删除"},on:{callConfirm:function(r){t.doDelete(e.row)}}}):t._e()]}}])})],1)],t._v(" "),r("div",{staticClass:"block"},[r("el-pagination",{staticClass:"pull-right clearfix",attrs:{current:1,"current-page":t.queryParams.page,"page-sizes":t.pageSizesList,"page-size":t.queryParams.rows,layout:"total, sizes, prev, pager, next, jumper","page-size-opts":t.pageSizesList,total:t.totalCount},on:{"current-change":t.changePage,"size-change":t.SizeChange,"update:currentPage":function(e){t.$set(t.queryParams,"page",e)}}})],1)],2)])],1)},[],!1,null,null,null);u.options.__file="qualityFileList.vue";e.default=u.exports}}]);